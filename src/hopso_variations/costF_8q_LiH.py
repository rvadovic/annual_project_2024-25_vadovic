# -*- coding: utf-8 -*-
"""
Created on Sat Jul 27 16:11:57 2024

@author: mirac
"""
#%%
from qiskit.quantum_info import SparsePauliOp
from qiskit.circuit.library import TwoLocal
from qiskit.primitives import Estimator
import numpy as np

#8-qubit labels
labels = ['IIIIIIII', 'IZZIIZZZ', 'IZZIIZZX', 'IIIIIIIX', 'IZZIIZXI', 'IIIIIIXZ', 'IIIIIXII', 'IZZIIXZZ', 'IIIIIIIZ', 'IIIIIIYY', 'IIIIIIXX', 'IZZIIYZY', 'IZZIIXZX',
         'IIIIIIZI', 'IZZIIYYI', 'IZZIIXXI', 'IIZIIIII', 'IZIIIIII', 'IIIIIZII', 'ZZZZZIII', 'ZZZZXIII', 'IIIIXIII', 'ZZZXIIII', 'IIIXZIII', 'XIIIIIII', 'XZZZZIII',
         'IIIIZIII', 'IIIYYIII', 'IIIXXIII', 'YZZZYIII', 'XZZZXIII', 'IIIZIIII', 'YZZYIIII', 'XZZXIIII', 'ZIIIIIII', 'IZZIIZZI', 'IZZIIZXX', 'IZZIIZYY', 'IIIIIXIX',
         'IIIIIYIY', 'IZZIIZXZ', 'IIIIIIXI', 'IIIIIXIZ', 'IZZIIXZI', 'IIIIIXYY', 'IIIIIXXX', 'IIIIIYYX', 'IZZIIYYX', 'IZZIIXXX', 'IZZIIXYY', 'IZZIIZIZ', 'IIIIIXXZ',
         'IIIIIYYZ', 'IZZIIZIX', 'IIIIIIZX', 'IIIIIXZI', 'IZZIIXIZ', 'IZIIIZZZ', 'IZIIIZZX', 'IIZIIIIX', 'IZIIIZXI', 'IIZIIIXZ', 'IIZIIXII', 'IZIIIXZZ', 'IIZIIZZZ',
         'IIZIIZZX', 'IZIIIIIX', 'IIZIIZXI', 'IZIIIIXZ', 'IZIIIXII', 'IIZIIXZZ', 'IZZIIIZZ', 'IZZIIIZX', 'IIIIIZIX', 'IZZIIIXI', 'IIIIIZXZ', 'ZIIZZZZZ', 'ZIIZZZZX',
         'ZZZZZIIX', 'ZIIZZZXI', 'ZZZZZIXZ', 'ZZZZZXII', 'ZIIZZXZZ', 'ZIIZXZZZ', 'IZZIXZZZ', 'ZIIZXZZX', 'IZZIXZZX', 'ZZZZXIIX', 'IIIIXIIX', 'ZIIZXZXI', 'IZZIXZXI', 
         'ZZZZXIXZ', 'IIIIXIXZ', 'ZZZZXXII', 'IIIIXXII', 'ZIIZXXZZ', 'IZZIXXZZ', 'ZIIXIZZZ', 'IZZXZZZZ', 'ZIIXIZZX', 'IZZXZZZX', 'ZZZXIIIX', 'IIIXZIIX', 'ZIIXIZXI', 
         'IZZXZZXI', 'ZZZXIIXZ', 'IIIXZIXZ', 'ZZZXIXII', 'IIIXZXII', 'ZIIXIXZZ', 'IZZXZXZZ', 'ZIXIIZII', 'IZXZZZII', 'ZZXIIIZZ', 'IIXZZIZZ', 'ZXIIIZII', 'IXZZZZII', 
         'ZXZIIIZZ', 'IXIZZIZZ', 'XZZIIZZZ', 'XIIZZZZZ', 'XZZIIZZX', 'XIIZZZZX', 'XIIIIIIX', 'XZZZZIIX', 'XZZIIZXI', 'XIIZZZXI', 'XIIIIIXZ', 'XZZZZIXZ', 'XIIIIXII', 
         'XZZZZXII', 'XZZIIXZZ', 'XIIZZXZZ', 'IZZIZZZZ', 'IZZIZZZX', 'IIIIZIIX', 'IZZIZZXI', 'IIIIZIXZ', 'IIIIZXII', 'IZZIZXZZ', 'IZZYYZZZ', 'IZZXXZZZ', 'IZZYYZZX', 
         'IZZXXZZX', 'IIIYYIIX', 'IIIXXIIX', 'IZZYYZXI', 'IZZXXZXI', 'IIIYYIXZ', 'IIIXXIXZ', 'IIIYYXII', 'IIIXXXII', 'IZZYYXZZ', 'IZZXXXZZ', 'IZYZYZII', 'IZXZXZII', 
         'IIYZYIZZ', 'IIXZXIZZ', 'IYZZYZII', 'IXZZXZII', 'IYIZYIZZ', 'IXIZXIZZ', 'YIIZYZZZ', 'XIIZXZZZ', 'YIIZYZZX', 'XIIZXZZX', 'YZZZYIIX', 'XZZZXIIX', 'YIIZYZXI', 
         'XIIZXZXI', 'YZZZYIXZ', 'XZZZXIXZ', 'YZZZYXII', 'XZZZXXII', 'YIIZYXZZ', 'XIIZXXZZ', 'IZZZIZZZ', 'IZZZIZZX', 'IIIZIIIX', 'IZZZIZXI', 'IIIZIIXZ', 'IIIZIXII', 
         'IZZZIXZZ', 'IZYYIZII', 'IZXXIZII', 'IIYYIIZZ', 'IIXXIIZZ', 'IYZYIZII', 'IXZXIZII', 'IYIYIIZZ', 'IXIXIIZZ', 'YIIYIZZZ', 'XIIXIZZZ', 'YIIYIZZX', 'XIIXIZZX', 
         'YZZYIIIX', 'XZZXIIIX', 'YIIYIZXI', 'XIIXIZXI', 'YZZYIIXZ', 'XZZXIIXZ', 'YZZYIXII', 'XZZXIXII', 'YIIYIXZZ', 'XIIXIXZZ', 'YIYIIZII', 'XIXIIZII', 'YZYIIIZZ', 
         'XZXIIIZZ', 'YYIIIZII', 'XXIIIZII', 'YYZIIIZZ', 'XXZIIIZZ', 'ZZZIIZZZ', 'ZZZIIZZX', 'ZIIIIIIX', 'ZZZIIZXI', 'ZIIIIIXZ', 'ZIIIIXII', 'ZZZIIXZZ', 'IIIIIIZZ', 
         'IZZIIYYZ', 'IZZIIXXZ', 'IZZIIYIY', 'IZZIIXIX', 'IIZIIIIZ', 'IIZIIIYY', 'IIZIIIXX', 'IZIIIYZY', 'IZIIIXZX', 'IZIIIIIZ', 'IZIIIIYY', 'IZIIIIXX', 'IIZIIYZY', 
         'IIZIIXZX', 'IIIIIZIZ', 'IIIIIZYY', 'IIIIIZXX', 'ZZZZZIIZ', 'ZZZZZIYY', 'ZZZZZIXX', 'ZIIZZYZY', 'ZIIZZXZX', 'ZZZZXIIZ', 'IIIIXIIZ', 'ZZZZXIYY', 'IIIIXIYY', 
         'ZZZZXIXX', 'IIIIXIXX', 'ZIIZXYZY', 'IZZIXYZY', 'ZIIZXXZX', 'IZZIXXZX', 'ZZZXIIIZ', 'IIIXZIIZ', 'ZZZXIIYY', 'IIIXZIYY', 'ZZZXIIXX', 'IIIXZIXX', 'ZIIXIYZY', 
         'IZZXZYZY', 'ZIIXIXZX', 'IZZXZXZX', 'ZZYIIIZY', 'IIYZZIZY', 'ZZXIIIZX', 'IIXZZIZX', 'ZYZIIIZY', 'IYIZZIZY', 'ZXZIIIZX', 'IXIZZIZX', 'XIIIIIIZ', 'XZZZZIIZ', 
         'XIIIIIYY', 'XZZZZIYY', 'XIIIIIXX', 'XZZZZIXX', 'XZZIIYZY', 'XIIZZYZY', 'XZZIIXZX', 'XIIZZXZX', 'IIIIZIIZ', 'IIIIZIYY', 'IIIIZIXX', 'IZZIZYZY', 'IZZIZXZX', 
         'IIIYYIIZ', 'IIIXXIIZ', 'IIIYYIYY', 'IIIXXIYY', 'IIIYYIXX', 'IIIXXIXX', 'IZZYYYZY', 'IZZXXYZY', 'IZZYYXZX', 'IZZXXXZX', 'IIXZYIZY', 'IIYZXIZY', 'IIYZYIZX', 
         'IIXZXIZX', 'IXIZYIZY', 'IYIZXIZY', 'IYIZYIZX', 'IXIZXIZX', 'YZZZYIIZ', 'XZZZXIIZ', 'YZZZYIYY', 'XZZZXIYY', 'YZZZYIXX', 'XZZZXIXX', 'YIIZYYZY', 'XIIZXYZY', 
         'YIIZYXZX', 'XIIZXXZX', 'IIIZIIIZ', 'IIIZIIYY', 'IIIZIIXX', 'IZZZIYZY', 'IZZZIXZX', 'IIXYIIZY', 'IIYXIIZY', 'IIYYIIZX', 'IIXXIIZX', 'IXIYIIZY', 'IYIXIIZY', 
         'IYIYIIZX', 'IXIXIIZX', 'YZZYIIIZ', 'XZZXIIIZ', 'YZZYIIYY', 'XZZXIIYY', 'YZZYIIXX', 'XZZXIIXX', 'YIIYIYZY', 'XIIXIYZY', 'YIIYIXZX', 'XIIXIXZX', 'YZXIIIZY', 
         'XZYIIIZY', 'YZYIIIZX', 'XZXIIIZX', 'YXZIIIZY', 'XYZIIIZY', 'YYZIIIZX', 'XXZIIIZX', 'ZIIIIIIZ', 'ZIIIIIYY', 'ZIIIIIXX', 'ZZZIIYZY', 'ZZZIIXZX', 'IIZIIIZI', 
         'IZIIIYYI', 'IZIIIXXI', 'IZIIIIZI', 'IIZIIYYI', 'IIZIIXXI', 'IIIIIZZI', 'ZZZZZIZI', 'ZIIZZYYI', 'ZIIZZXXI', 'ZZZZXIZI', 'IIIIXIZI', 'ZIIZXYYI', 'IZZIXYYI', 
         'ZIIZXXXI', 'IZZIXXXI', 'ZZZXIIZI', 'IIIXZIZI', 'ZIIXIYYI', 'IZZXZYYI', 'ZIIXIXXI', 'IZZXZXXI', 'ZZYIIIYI', 'IIYZZIYI', 'ZZXIIIXI', 'IIXZZIXI', 'ZYZIIIYI', 
         'IYIZZIYI', 'ZXZIIIXI', 'IXIZZIXI', 'XIIIIIZI', 'XZZZZIZI', 'XZZIIYYI', 'XIIZZYYI', 'XZZIIXXI', 'XIIZZXXI', 'IIIIZIZI', 'IZZIZYYI', 'IZZIZXXI', 'IIIYYIZI', 
         'IIIXXIZI', 'IZZYYYYI', 'IZZXXYYI', 'IZZYYXXI', 'IZZXXXXI', 'IIXZYIYI', 'IIYZXIYI', 'IIYZYIXI', 'IIXZXIXI', 'IXIZYIYI', 'IYIZXIYI', 'IYIZYIXI', 'IXIZXIXI', 
         'YZZZYIZI', 'XZZZXIZI', 'YIIZYYYI', 'XIIZXYYI', 'YIIZYXXI', 'XIIZXXXI', 'IIIZIIZI', 'IZZZIYYI', 'IZZZIXXI', 'IIXYIIYI', 'IIYXIIYI', 'IIYYIIXI', 'IIXXIIXI', 
         'IXIYIIYI', 'IYIXIIYI', 'IYIYIIXI', 'IXIXIIXI', 'YZZYIIZI', 'XZZXIIZI', 'YIIYIYYI', 'XIIXIYYI', 'YIIYIXXI', 'XIIXIXXI', 'YZXIIIYI', 'XZYIIIYI', 'YZYIIIXI', 
         'XZXIIIXI', 'YXZIIIYI', 'XYZIIIYI', 'YYZIIIXI', 'XXZIIIXI', 'ZIIIIIZI', 'ZZZIIYYI', 'ZZZIIXXI', 'IZZIIIII', 'IIZIIZII', 'ZZIZZIII', 'ZZIZXIII', 'IIZIXIII', 
         'ZZIXIIII', 'IIZXZIII', 'ZIYIIYII', 'IZYZZYII', 'ZIXIIXII', 'IZXZZXII', 'XIZIIIII', 'XZIZZIII', 'IIZIZIII', 'IIZYYIII', 'IIZXXIII', 'IZXZYYII', 'IZYZXYII', 
         'IZYZYXII', 'IZXZXXII', 'YZIZYIII', 'XZIZXIII', 'IIZZIIII', 'IZXYIYII', 'IZYXIYII', 'IZYYIXII', 'IZXXIXII', 'YZIYIIII', 'XZIXIIII', 'IXXIIIII', 'IYYIIIII', 
         'YIXIIYII', 'XIYIIYII', 'YIYIIXII', 'XIXIIXII', 'ZIZIIIII', 'IZIIIZII', 'ZIZZZIII', 'ZIZZXIII', 'IZIIXIII', 'ZIZXIIII', 'IZIXZIII', 'ZYIIIYII', 'IYZZZYII', 
         'ZXIIIXII', 'IXZZZXII', 'XZIIIIII', 'XIZZZIII', 'IZIIZIII', 'IZIYYIII', 'IZIXXIII', 'IXZZYYII', 'IYZZXYII', 'IYZZYXII', 'IXZZXXII', 'YIZZYIII', 'XIZZXIII', 
         'IZIZIIII', 'IXZYIYII', 'IYZXIYII', 'IYZYIXII', 'IXZXIXII', 'YIZYIIII', 'XIZXIIII', 'YXIIIYII', 'XYIIIYII', 'YYIIIXII', 'XXIIIXII', 'ZZIIIIII', 'ZZZZZZII', 
         'ZZZZXZII', 'IIIIXZII', 'ZZZXIZII', 'IIIXZZII', 'XIIIIZII', 'XZZZZZII', 'IIIIZZII', 'IIIYYZII', 'IIIXXZII', 'YZZZYZII', 'XZZZXZII', 'IIIZIZII', 'YZZYIZII', 
         'XZZXIZII', 'ZIIIIZII', 'ZZZZIIII', 'ZZZXXIII', 'ZZZYYIII', 'XIIIXIII', 'YIIIYIII', 'ZZZXZIII', 'IIIXIIII', 'XIIIZIII', 'XZZZIIII', 'XIIYYIII', 'XIIXXIII', 
         'YIIYXIII', 'YZZYXIII', 'XZZXXIII', 'XZZYYIII', 'ZZZIZIII', 'XIIXZIII', 'YIIYZIII', 'ZZZIXIII', 'IIIZXIII', 'XIIZIIII', 'XZZIZIII', 'IZZZZIII', 'IZZZXIII', 
         'ZIIIXIII', 'IZZXIIII', 'ZIIXZIII', 'IIIZZIII', 'YZZYZIII', 'XZZXZIII', 'YZZIYIII', 'XZZIXIII', 'ZIIIZIII', 'ZIIYYIII', 'ZIIXXIII', 'ZIIZIIII']
coeffs = [(-4.988503953631935+0j), (1.0087117017128928+0j), (-0.014742860701465514+0j), (0.014742860701465514+0j), (-0.025554376840245027+0j), (0.025554376840245027+0j), 
          (0.000892887208374395+0j), (-0.000892887208374395+0j), (-0.11669812839130742+0j), (-0.00763148577225518+0j), (-0.00763148577225518+0j), (0.005931074813983064+0j), 
          (0.005931074813983064+0j), (-0.19773693497440442+0j), (0.014602536839345011+0j), (0.014602536839345011+0j), (-0.45924403531579755+0j), (-0.4592440353157976+0j), 
          (-0.3921738347334874+0j), (1.0087117017128933+0j), (-0.014742860701465577+0j), (0.014742860701465577+0j), (-0.02555437684024498+0j), (0.02555437684024498+0j), 
          (0.0008928872083743939+0j), (-0.0008928872083743939+0j), (-0.11669812839130751+0j), (-0.007631485772255177+0j), (-0.007631485772255177+0j), (0.005931074813983059+0j), 
          (0.005931074813983059+0j), (-0.19773693497440453+0j), (0.014602536839345016+0j), (0.014602536839345016+0j), (-0.3921738347334874+0j), (0.08981333348776849+0j), 
          (0.0002470865807618955+0j), (0.0002470865807618955+0j), (-0.006624128763848125+0j), (-0.006624128763848125+0j), (-0.003247196737969148+0j), (0.003247196737969148+0j), 
          (-0.0029189446624547895+0j), (0.0029189446624547895+0j), (-0.00038881839273047865+0j), (-0.0013577262659730466+0j), (-0.0009689078732425674+0j), (-0.0009689078732425674+0j), 
          (-0.0013577262659730466+0j), (-0.00038881839273047865+0j), (0.09355955740366553+0j), (0.004828469764372238+0j), (0.004828469764372238+0j), (-0.0028913887649858303+0j), 
          (0.0028913887649858303+0j), (0.001396035105618235+0j), (-0.001396035105618235+0j), (0.19570240962718116+0j), (-0.004121355295189859+0j), (0.004121355295189859+0j), 
          (-0.005041332803018909+0j), (0.005041332803018909+0j), (0.0017100589060386672+0j), (-0.0017100589060386672+0j), (0.19570240962718122+0j), (-0.004121355295189862+0j), 
          (0.004121355295189862+0j), (-0.005041332803018909+0j), (0.005041332803018909+0j), (0.0017100589060386688+0j), (-0.0017100589060386688+0j), (0.0884684221257211+0j), 
          (0.0008858660045390596+0j), (-0.0008858660045390596+0j), (-0.0039011347589671453+0j), (0.0039011347589671453+0j), (0.4145960467361261+0j), (-0.02856906194286898+0j), 
          (0.02856906194286898+0j), (-0.03452608676060419+0j), (0.03452608676060419+0j), (0.012096681162908688+0j), (-0.012096681162908688+0j), (-0.028569061942868984+0j), 
          (0.028569061942868984+0j), (0.003501247382918566+0j), (-0.003501247382918566+0j), (-0.003501247382918566+0j), (0.003501247382918566+0j), (0.002844684118188048+0j), 
          (-0.002844684118188048+0j), (-0.002844684118188048+0j), (0.002844684118188048+0j), (-0.0021397473591264747+0j), (0.0021397473591264747+0j), (0.0021397473591264747+0j), 
          (-0.0021397473591264747+0j), (-0.03452608676060419+0j), (0.03452608676060419+0j), (0.002844684118188048+0j), (-0.002844684118188048+0j), (-0.002844684118188048+0j), 
          (0.002844684118188048+0j), (0.0053971349650047615+0j), (-0.0053971349650047615+0j), (-0.0053971349650047615+0j), (0.0053971349650047615+0j), (-0.0004554890480375092+0j), 
          (0.0004554890480375092+0j), (0.0004554890480375092+0j), (-0.0004554890480375092+0j), (0.002454631350440893+0j), (-0.002454631350440893+0j), (-0.002454631350440893+0j), 
          (0.002454631350440893+0j), (0.002454631350440893+0j), (-0.002454631350440893+0j), (-0.002454631350440893+0j), (0.002454631350440893+0j), (0.012096681162908688+0j), 
          (-0.012096681162908688+0j), (-0.0021397473591264742+0j), (0.0021397473591264742+0j), (0.0021397473591264742+0j), (-0.0021397473591264742+0j), (-0.00045548904803750914+0j), 
          (0.00045548904803750914+0j), (0.00045548904803750914+0j), (-0.00045548904803750914+0j), (0.0019750445457964406+0j), (-0.0019750445457964406+0j), (-0.0019750445457964406+0j), 
          (0.0019750445457964406+0j), (0.09331458087068703+0j), (0.001684277431668603+0j), (-0.001684277431668603+0j), (-0.004123040337830278+0j), (0.004123040337830278+0j), 
          (-0.0016120261914684597+0j), (0.0016120261914684597+0j), (-0.0030917706989499424+0j), (-0.0030917706989499424+0j), (0.0008758435998611308+0j), (0.0008758435998611308+0j), 
          (-0.0008758435998611308+0j), (-0.0008758435998611308+0j), (-5.172669061580785e-05+0j), (-5.172669061580785e-05+0j), (5.172669061580785e-05+0j), (5.172669061580785e-05+0j), 
          (-0.0003673688232102457+0j), (-0.0003673688232102457+0j), (0.0003673688232102457+0j), (0.0003673688232102457+0j), (-0.0018832437601555981+0j), (-0.0018832437601555981+0j), 
          (0.0018832437601555981+0j), (0.0018832437601555981+0j), (-0.0018832437601555983+0j), (-0.0018832437601555983+0j), (0.0018832437601555983+0j), (0.0018832437601555983+0j), 
          (0.008763876122974601+0j), (0.008763876122974601+0j), (-0.0013069184709863311+0j), (-0.0013069184709863311+0j), (0.0013069184709863311+0j), (0.0013069184709863311+0j), 
          (2.1449569520233115e-05+0j), (2.1449569520233115e-05+0j), (-2.1449569520233115e-05+0j), (-2.1449569520233115e-05+0j), (-6.0105529646887575e-05+0j), (-6.0105529646887575e-05+0j), 
          (6.0105529646887575e-05+0j), (6.0105529646887575e-05+0j), (0.09895669236867029+0j), (-0.0028396620743700207+0j), (0.0028396620743700207+0j), (0.00047905267283199714+0j), 
          (-0.00047905267283199714+0j), (0.0025090192231687755+0j), (-0.0025090192231687755+0j), (-0.0025623903948187787+0j), (-0.0025623903948187787+0j), (0.0025623903948187787+0j), 
          (0.0025623903948187787+0j), (-0.0025623903948187796+0j), (-0.0025623903948187796+0j), (0.0025623903948187796+0j), (0.0025623903948187796+0j), (-0.00437298071633473+0j), 
          (-0.00437298071633473+0j), (0.0009903574427628007+0j), (0.0009903574427628007+0j), (-0.0009903574427628007+0j), (-0.0009903574427628007+0j), (-0.0011129841175505399+0j), 
          (-0.0011129841175505399+0j), (0.0011129841175505399+0j), (0.0011129841175505399+0j), (-0.0010639354560186233+0j), (-0.0010639354560186233+0j), (0.0010639354560186233+0j), 
          (0.0010639354560186233+0j), (0.0015148814402507484+0j), (0.0015148814402507484+0j), (-0.0015148814402507484+0j), (-0.0015148814402507484+0j), (0.0015148814402507484+0j), 
          (0.0015148814402507484+0j), (-0.0015148814402507484+0j), (-0.0015148814402507484+0j), (0.09044346667151755+0j), (0.0009459715341859472+0j), (-0.0009459715341859472+0j), 
          (-0.0028371993029485216+0j), (0.0028371993029485216+0j), (-0.0006523490210767924+0j), (0.0006523490210767924+0j), (0.053149299296670505+0j), (0.0042801745632079355+0j), 
          (0.0042801745632079355+0j), (0.004958861420478259+0j), (0.004958861420478259+0j), (0.13045931889894347+0j), (0.0022054582814017175+0j), (0.0022054582814017175+0j), 
          (0.001877634506430728+0j), (0.001877634506430728+0j), (0.1304593188989435+0j), (0.002205458281401719+0j), (0.002205458281401719+0j), (0.0018776345064307207+0j), 
          (0.0018776345064307207+0j), (0.08310642186719826+0j), (0.002822853017034635+0j), (0.002822853017034635+0j), (0.09331458087068703+0j), (-0.0030917706989499424+0j), 
          (-0.0030917706989499424+0j), (0.0087638761229746+0j), (0.0087638761229746+0j), (0.001684277431668603+0j), (-0.001684277431668603+0j), (0.0008758435998611308+0j), 
          (-0.0008758435998611308+0j), (0.0008758435998611308+0j), (-0.0008758435998611308+0j), (-0.0013069184709863311+0j), (0.0013069184709863311+0j), (-0.0013069184709863311+0j), 
          (0.0013069184709863311+0j), (-0.004123040337830278+0j), (0.004123040337830278+0j), (-5.172669061580785e-05+0j), (5.172669061580785e-05+0j), (-5.172669061580785e-05+0j), 
          (5.172669061580785e-05+0j), (2.1449569520233115e-05+0j), (-2.1449569520233115e-05+0j), (2.1449569520233115e-05+0j), (-2.1449569520233115e-05+0j), (-0.0018832437601555981+0j), 
          (0.0018832437601555981+0j), (-0.0018832437601555981+0j), (0.0018832437601555981+0j), (-0.0018832437601555983+0j), (0.0018832437601555983+0j), (-0.0018832437601555983+0j), 
          (0.0018832437601555983+0j), (-0.0016120261914684597+0j), (0.0016120261914684597+0j), (-0.0003673688232102457+0j), (0.0003673688232102457+0j), (-0.0003673688232102457+0j), 
          (0.0003673688232102457+0j), (-6.010552964688759e-05+0j), (6.010552964688759e-05+0j), (-6.010552964688759e-05+0j), (6.010552964688759e-05+0j), (0.12274244052545143+0j), 
          (0.011925529284481389+0j), (0.011925529284481389+0j), (-0.03239529731986452+0j), (-0.03239529731986452+0j), (0.011925529284481389+0j), (0.011925529284481389+0j), 
          (0.003139482375497464+0j), (0.003139482375497464+0j), (0.003139482375497464+0j), (0.003139482375497464+0j), (-0.008499158469806097+0j), (-0.008499158469806097+0j), 
          (-0.008499158469806097+0j), (-0.008499158469806097+0j), (-0.005928916533102496+0j), (0.005928916533102496+0j), (0.005928916533102496+0j), (0.005928916533102496+0j), 
          (-0.005928916533102498+0j), (0.005928916533102498+0j), (0.005928916533102498+0j), (0.005928916533102498+0j), (-0.03239529731986452+0j), (-0.03239529731986452+0j), 
          (-0.008499158469806097+0j), (-0.008499158469806097+0j), (-0.008499158469806097+0j), (-0.008499158469806097+0j), (0.030846096963274373+0j), (0.030846096963274373+0j), 
          (0.030846096963274373+0j), (0.030846096963274373+0j), (0.05628878167216797+0j), (-0.0016974649623867296+0j), (-0.0016974649623867296+0j), (0.0027372506123350326+0j), 
          (0.0027372506123350326+0j), (-0.004809206450331084+0j), (0.004809206450331084+0j), (0.004809206450331084+0j), (0.004809206450331084+0j), (-0.004809206450331085+0j), 
          (0.004809206450331085+0j), (0.004809206450331085+0j), (0.004809206450331085+0j), (0.012779333033014033+0j), (0.012779333033014033+0j), (0.002221610808143227+0j), 
          (0.002221610808143227+0j), (0.002221610808143227+0j), (0.002221610808143227+0j), (-0.007859003265895824+0j), (-0.007859003265895824+0j), (-0.007859003265895824+0j), 
          (-0.007859003265895824+0j), (0.004890562019499969+0j), (-0.004890562019499969+0j), (-0.004890562019499969+0j), (-0.004890562019499969+0j), (0.004890562019499969+0j), 
          (-0.004890562019499969+0j), (-0.004890562019499969+0j), (-0.004890562019499969+0j), (0.11395251883047261+0j), (0.010681856282930459+0j), (0.010681856282930459+0j), 
          (-0.03438974814048047+0j), (-0.03438974814048047+0j), (0.13073488182192297+0j), (-0.004347376649778053+0j), (-0.004347376649778053+0j), (0.13073488182192297+0j), 
          (-0.004347376649778064+0j), (-0.004347376649778064+0j), (0.0538525443830966+0j), (0.09895669236867029+0j), (-0.00437298071633473+0j), (-0.00437298071633473+0j), 
          (-0.002839662074370021+0j), (0.002839662074370021+0j), (0.0009903574427628007+0j), (-0.0009903574427628007+0j), (0.0009903574427628007+0j), (-0.0009903574427628007+0j), 
          (0.00047905267283199714+0j), (-0.00047905267283199714+0j), (-0.0011129841175505399+0j), (0.0011129841175505399+0j), (-0.0011129841175505399+0j), (0.0011129841175505399+0j), 
          (-0.002562390394818779+0j), (0.002562390394818779+0j), (-0.002562390394818779+0j), (0.002562390394818779+0j), (-0.0025623903948187796+0j), (0.0025623903948187796+0j), 
          (-0.0025623903948187796+0j), (0.0025623903948187796+0j), (0.002509019223168775+0j), (-0.002509019223168775+0j), (-0.0010639354560186233+0j), (0.0010639354560186233+0j), 
          (-0.0010639354560186233+0j), (0.0010639354560186233+0j), (0.05628878167216797+0j), (0.012779333033014033+0j), (0.012779333033014033+0j), (-0.00169746496238673+0j), 
          (-0.00169746496238673+0j), (0.0022216108081432265+0j), (0.0022216108081432265+0j), (0.0022216108081432265+0j), (0.0022216108081432265+0j), (-0.004809206450331084+0j), 
          (0.004809206450331084+0j), (0.004809206450331084+0j), (0.004809206450331084+0j), (-0.004809206450331085+0j), (0.004809206450331085+0j), (0.004809206450331085+0j), 
          (0.004809206450331085+0j), (0.0027372506123350326+0j), (0.0027372506123350326+0j), (-0.007859003265895824+0j), (-0.007859003265895824+0j), (-0.007859003265895824+0j), 
          (-0.007859003265895824+0j), (0.08460131391824206+0j), (-0.009002501243838557+0j), (-0.009002501243838557+0j), (-0.010323101079295216+0j), (0.010323101079295216+0j), 
          (0.010323101079295216+0j), (0.010323101079295216+0j), (-0.010323101079295216+0j), (0.010323101079295216+0j), (0.010323101079295216+0j), (0.010323101079295216+0j), 
          (-0.009002501243838557+0j), (-0.009002501243838557+0j), (0.006587584190054828+0j), (0.006587584190054828+0j), (0.006587584190054828+0j), (0.006587584190054828+0j), 
          (0.0034522696762380027+0j), (-0.0034522696762380027+0j), (-0.0034522696762380027+0j), (-0.0034522696762380027+0j), (0.0034522696762380044+0j), (-0.0034522696762380044+0j), 
          (-0.0034522696762380044+0j), (-0.0034522696762380044+0j), (0.06044012857315143+0j), (0.01095277357379615+0j), (0.01095277357379615+0j), (0.2707726623751816+0j), 
          (0.1294881663056809+0j), (0.19570240962718116+0j), (-0.004121355295189859+0j), (0.004121355295189859+0j), (-0.005041332803018909+0j), (0.005041332803018909+0j), 
          (0.0015148814402507484+0j), (-0.0015148814402507484+0j), (0.0015148814402507484+0j), (-0.0015148814402507484+0j), (0.0017100589060386672+0j), (-0.0017100589060386672+0j), 
          (0.13045931889894347+0j), (0.0022054582814017175+0j), (0.0022054582814017175+0j), (0.004890562019499968+0j), (-0.004890562019499968+0j), (-0.004890562019499968+0j), 
          (-0.004890562019499968+0j), (0.0018776345064307276+0j), (0.0018776345064307276+0j), (0.13073488182192297+0j), (0.003452269676238003+0j), (-0.003452269676238003+0j), 
          (-0.003452269676238003+0j), (-0.003452269676238003+0j), (-0.004347376649778053+0j), (-0.004347376649778053+0j), (0.0084345697568455+0j), (0.0084345697568455+0j), 
          (-0.004902761294508434+0j), (0.004902761294508434+0j), (0.004902761294508434+0j), (0.004902761294508434+0j), (0.1294881663056809+0j), (0.12948816630568094+0j), 
          (0.19570240962718122+0j), (-0.004121355295189862+0j), (0.004121355295189862+0j), (-0.005041332803018909+0j), (0.005041332803018909+0j), (0.0015148814402507487+0j), 
          (-0.0015148814402507487+0j), (0.0015148814402507487+0j), (-0.0015148814402507487+0j), (0.0017100589060386688+0j), (-0.0017100589060386688+0j), (0.1304593188989435+0j), 
          (0.002205458281401719+0j), (0.002205458281401719+0j), (0.004890562019499969+0j), (-0.004890562019499969+0j), (-0.004890562019499969+0j), (-0.004890562019499969+0j), 
          (0.0018776345064307207+0j), (0.0018776345064307207+0j), (0.13073488182192297+0j), (0.003452269676238004+0j), (-0.003452269676238004+0j), (-0.003452269676238004+0j), 
          (-0.003452269676238004+0j), (-0.004347376649778064+0j), (-0.004347376649778064+0j), (-0.004902761294508436+0j), (0.004902761294508436+0j), (0.004902761294508436+0j), 
          (0.004902761294508436+0j), (0.12948816630568094+0j), (0.09044346667151755+0j), (0.0009459715341859472+0j), (-0.0009459715341859472+0j), (-0.0028371993029485216+0j), 
          (0.0028371993029485216+0j), (-0.0006523490210767925+0j), (0.0006523490210767925+0j), (0.11395251883047261+0j), (0.01068185628293046+0j), (0.01068185628293046+0j), 
          (-0.03438974814048047+0j), (-0.03438974814048047+0j), (0.06044012857315143+0j), (0.01095277357379615+0j), (0.01095277357379615+0j), (0.11384335176465168+0j), 
          (0.08981333348776849+0j), (0.0002470865807618955+0j), (0.0002470865807618955+0j), (-0.006624128763848125+0j), (-0.006624128763848125+0j), (-0.003247196737969148+0j), 
          (0.003247196737969148+0j), (-0.0029189446624547895+0j), (0.0029189446624547895+0j), (-0.00038881839273047865+0j), (-0.0013577262659730466+0j), (-0.0009689078732425674+0j), 
          (-0.0009689078732425674+0j), (-0.0013577262659730466+0j), (-0.00038881839273047865+0j), (0.09355955740366553+0j), (0.004828469764372238+0j), (0.004828469764372238+0j), 
          (-0.0028913887649858303+0j), (0.0028913887649858303+0j), (0.001396035105618235+0j), (-0.001396035105618235+0j), (0.0884684221257211+0j), (0.0008858660045390596+0j), 
          (-0.0008858660045390596+0j), (-0.0039011347589671453+0j), (0.0039011347589671453+0j), (0.053149299296670505+0j), (0.0042801745632079355+0j), (0.0042801745632079355+0j), 
          (0.004958861420478259+0j), (0.004958861420478259+0j), (0.08310642186719826+0j), (0.002822853017034635+0j), (0.002822853017034635+0j), (0.0538525443830966+0j)]
H = SparsePauliOp(labels,coeffs)
#%%

estimator = Estimator()
ansatz = TwoLocal(8, ["rx","ry"],"cx", reps=4, entanglement="linear",insert_barriers=True).decompose()

#%%
def cost_fn_8qlih(angle):
    job = estimator.run([ansatz], [H], [angle])
    energy = job.result().values[0] # It will block until the job finishes.
    return energy
#%%
